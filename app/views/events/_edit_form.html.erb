<!-- FORM 3: Edit Event Form -->
<div class="container mt-5" style="max-width: 600px;">
  <h2 class="mb-4 text-center">Edit Event</h2>

  <%= form_with model: event, local: true, class: "needs-validation" do |f| %>

    <!-- Display current artist and venue (non-editable) -->
    <div class="mb-3">
      <label class="form-label">Artist</label>
      <p class="form-control-plaintext"><%= event.artist.username %></p>
    </div>

    <div class="mb-3">
      <label class="form-label">Venue</label>
      <p class="form-control-plaintext"><%= event.venue.name %></p>
    </div>

    <!-- Category Dropdown -->
    <div class="mb-3">
      <%= f.label :category, class: "form-label" %>
      <%= f.select :category, ["Guitar", "Piano", "Band", "DJ"], 
          {}, 
          { class: "form-select", required: true } %>
    </div>

    <!-- Description -->
    <div class="mb-3">
      <%= f.label :description, class: "form-label" %>
      <%= f.text_area :description, 
          class: "form-control", 
          placeholder: "Describe the event", 
          rows: 3 %>
    </div>

    <!-- Date Dropdown (Next 14 Days) -->
    <div class="mb-3">
      <%= f.label :date, class: "form-label" %>
      <%= f.select :date,
        (0..13).map { |i|
        date = Date.today + i.days
        [date.strftime("%A, %B %-d"), date.to_s]
        },
        {},
        { class: "form-select", required: true } %>
    </div>

    <!-- Start Time Dropdown -->
    <div class="mb-3">
      <%= f.label :start_time, "Start Time", class: "form-label" %>
      <%= f.select :start_time, time_options, 
      { selected: event.start_time&.strftime("%H:%M") }, 
      { class: "form-select", required: true } %>
    </div>

    <!-- End Time Dropdown -->
    <div class="mb-3">
      <%= f.label :end_time, "End Time", class: "form-label" %>
      <%= f.select :end_time, time_options, 
      { selected: event.end_time&.strftime("%H:%M") }, 
      { class: "form-select", required: true } %>
    </div>

    <!-- Cover Checkbox -->
    <div class="form-check mb-3">
      <%= f.check_box :cover, 
          class: "form-check-input", 
          id: "event_cover",
          onchange: "toggleCoverAmount()" %>
      <%= f.label :cover, "Cover Charge?", class: "form-check-label" %>
    </div>

    <!-- Cover Amount Field (show/hide based on existing value) -->
    <div class="mb-3" id="cover-amount-field" style="display: <%= event.cover? ? 'block' : 'none' %>;">
      <%= f.label :cover_amount, "Cover Amount ($)", class: "form-label" %>
      <%= f.number_field :cover_amount, 
          class: "form-control", 
          placeholder: "Enter amount",
          min: 1,
          step: 1 %>
    </div>

    <!-- Indoors Checkbox -->
    <div class="form-check mb-4">
      <%= f.check_box :indoors, class: "form-check-input" %>
      <%= f.label :indoors, "Indoors?", class: "form-check-label" %>
    </div>

    <div class="d-grid">
      <%= f.submit "Update Event", class: "btn btn-primary" %>
    </div>

  <% end %>
</div>

<!-- Your existing layout content -->

<script>
function toggleCoverAmount() {
  const checkbox = document.getElementById('event_cover');
  const coverAmountField = document.getElementById('cover-amount-field');
  
  if (checkbox && coverAmountField) {
    const coverAmountInput = coverAmountField.querySelector('input[type="number"]');
    
    if (checkbox.checked) {
      coverAmountField.style.display = 'block';
      if (coverAmountInput) coverAmountInput.required = true;
    } else {
      coverAmountField.style.display = 'none';
      if (coverAmountInput) {
        coverAmountInput.required = false;
        coverAmountInput.value = '';
      }
    }
  }
}

// Run on page load to set initial state
document.addEventListener('DOMContentLoaded', function() {
  toggleCoverAmount();
});
</script>

</body>
</html>
