<% content_for :title, "Upcoming Events Near You" %>

<% if notice.present? %>
  <div class="alert alert-success text-center">
    <%= notice %>
  </div>
<% end %>

<h1 class="mb-4">Events Near You</h1>

<div id="events" class="row g-4">
  <% @events.each do |event| %>
    <% venue = event.venue %>
    <div class="col-12">
      <div class="card shadow-sm">
        <% if venue.image.attached? %>
          <%= image_tag venue.image.variant(resize_to_fill: [1200, 300]), class: "card-img-top" %>
        <% end %>

        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="card-title mb-1">
              <%= link_to venue.name, venue_path(venue), class: "text-decoration-none" %>
            </h5>
            <span class="badge bg-primary">
              <%= event.artist&.username || event.artist_name %>
            </span>
          </div>

          <p class="card-text">
            <%= link_to venue.full_address, "https://www.google.com/maps/search/?api=1&query=#{CGI.escape(venue.full_address)}", target: "_blank", class: "text-decoration-none" %><br>
            <strong>
              <%= event.date == Date.today ? "Today" : event.date.strftime("%B %-d") %>
              &middot;
              <%= event.start_time.strftime("%l:%M %p") %> - <%= event.end_time.strftime("%l:%M %p") %>
            </strong>
          </p>

          <%= link_to "View Event", event_path(event), class: "btn btn-outline-primary btn-sm" %>
        </div>
      </div>
    </div>
  <% end %>
</div>
