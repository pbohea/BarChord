<% content_for :title, "Find Live Music Near You" %>

<div class="container my-5" style="max-width: 540px;">
  <!-- Header Section -->
  <div class="text-center mb-4">
    <p class="text-muted mt-4">Search a time and place to find live music</p>
  </div>

<div class="container my-5" style="max-width: 540px;">
  <div class="card shadow-sm border-0">
    <div class="card-body p-4">

      <%= form_with url: events_path, method: :get, local: true, 
                    data: { 
                      controller: "location-search",
                      action: "submit->location-search#validateLocation"
                    } do |f| %>

        <!-- Location Options -->
        <div class="mb-3">
          <label class="form-label small text-muted">Location</label>
          
          <div class="form-check mb-2">
            <%= radio_button_tag :location_type, "address", true, 
                class: "form-check-input", 
                data: { "location-search-target": "addressRadio" } %>
            <%= label_tag :location_type_address, "Enter address", class: "form-check-label" %>
          </div>
          
          <%= f.text_field :address,
                placeholder: "Enter address or ZIP code",
                class: "form-control form-control-sm mb-2",
                required: true,
                data: { "location-search-target": "addressInput" } %>
          
          <div class="form-check">
            <%= radio_button_tag :location_type, "current", false, 
                class: "form-check-input", 
                data: { "location-search-target": "currentRadio", action: "change->location-search#getCurrentLocation" } %>
            <%= label_tag :location_type_current, "Use my current location", class: "form-check-label" %>
          </div>
        </div>

        <!-- Search Radius -->
        <div class="mb-3">
          <%= f.label :radius, "Search Radius", class: "form-label small text-muted" %>
          <%= f.select :radius,
                options_for_select([
                  ['1 mi', 1], ['5 mi', 5], ['10 mi', 10],
                  ['15 mi', 15], ['25 mi', 25], ['50 mi', 50]
                ], 5),
                {}, class: "form-select form-select-sm" %>
        </div>

        <!-- Date Range -->
        <div class="mb-3">
          <%= f.label :date_range, "Show events for", class: "form-label small text-muted" %>
          <%= f.select :date_range,
                options_for_select([
                  ["Any Date", ""],
                  ["Today", "today"],
                  ["Next 7 Days", "next_7_days"]
                ]),
                {}, class: "form-select form-select-sm" %>
        </div>

        <!-- Error message container -->
        <div id="location-error" class="alert alert-danger d-none mb-3" role="alert">
          Please enter an address or use your current location before searching.
        </div>

        <!-- Submit Button -->
        <div class="d-grid">
          <%= f.submit "Search Events", class: "btn btn-primary btn-sm" %>
        </div>

        <%= f.hidden_field :lat, data: { "location-search-target": "latInput" } %>
        <%= f.hidden_field :lng, data: { "location-search-target": "lngInput" } %>
      <% end %>

    </div>
  </div>
</div>
