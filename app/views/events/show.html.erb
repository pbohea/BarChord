<% content_for :title, "Event Information" %>

<div class="container mb-3 pt-3" style="max-width: 500px;">
  <div class="card shadow-sm">
    <div class="card-body text-center">

      <!-- Venue Name Link at Top -->
      <div class="d-flex justify-content-center">
        <%= link_to @event.venue.name, 
              venue_path(@event.venue), 
              class: "btn btn-outline-primary mb-3" %>
      </div>

      <!-- Artist Image -->
      <% if @event.artist&.image&.attached? %>
        <%= link_to artist_path(@event.artist), data: { turbo_frame: "_top" } do %>
          <%= image_tag @event.artist.image.variant(resize_to_fill: [80, 80]),
                class: "rounded-circle mb-2 shadow",
                style: "object-fit: cover;" %>
        <% end %>
      <% else %>
        <div class="rounded-circle bg-secondary mb-2 d-flex align-items-center justify-content-center mx-auto" style="width: 80px; height: 80px; color: white;">
          <i class="fas fa-user fa-lg"></i>
        </div>
      <% end %>

      <!-- Artist Name -->
      <p class="mb-0">
        <%= link_to @event.artist.username, artist_path(@event.artist),
              class: "text-decoration-none text-primary fw-semibold",
              data: { turbo_frame: "_top" } %>
      </p>
    </div>

    <!-- Event Details List -->
    <ul class="list-group list-group-flush mb-0">
      <li class="list-group-item text-muted">
        <%= @event.description.presence || @event.category %>
      </li>

      <li class="list-group-item">
        <strong>Date:</strong> <%= @event.date.strftime("%A, %B %-d") %><br>
        <strong>Time:</strong>
        <%= @event.start_time.strftime("%-I:%M %p") %> â€“ <%= @event.end_time.strftime("%-I:%M %p") %>
      </li>

      <li class="list-group-item">
        <strong>Location:</strong> <%= @event.indoors? ? "Indoors" : "Outdoors" %>
      </li>

      <li class="list-group-item">
        <strong>Cover Charge:</strong>
        <%= @event.cover? ? number_to_currency(@event.cover_amount || 5) : "No Cover" %>
      </li>
    </ul>
  </div>

  <% if @event.venue.website.present? %>
    <div class="d-grid mt-3">
      <%= link_to "Go to event", @event.venue.website,
            class: "btn btn-primary",
            target: "_blank",
            rel: "noopener",
            data: { turbo: false } %>
    </div>
  <% end %>

<!-- Add this wherever appropriate in your show view -->
<% if can_modify_event?(@event) %>
  <div class="mt-4">
    <%= link_to "Edit Event", 
        edit_event_path(@event), 
        class: "btn btn-warning me-2" %>
    
    <%= button_to "Cancel Event", 
        event_path(@event), 
        method: :delete, 
        class: "btn btn-danger",
        confirm: "Are you sure you want to cancel this event? This action cannot be undone.",
        form: { class: "d-inline" } %>
  </div>
<% end %>
